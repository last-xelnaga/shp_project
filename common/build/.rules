
C  = $(PREFIX)gcc
CC = $(PREFIX)g++

CFLAGS   = $(FLAGS) -DDEBUG_TAG="$(TARGET)" -Wall -Wextra -std=c99
CXXFLAGS = $(FLAGS) -DDEBUG_TAG="$(TARGET)" -pedantic -Wextra -Wall -std=c++11


OBJC = $(SRCC:%.c=$(OBJDIR)/%.o)

$(OBJDIR)/%.o :%.c
	$(C) -c $(CFLAGS) $(INC) $< -o $@


OBJCPP = $(SRCCPP:%.cpp=$(OBJDIR)/%.o)

$(OBJDIR)/%.o :%.cpp
	$(CC) -c $(CXXFLAGS) $(INC) $< -o $@

.PHONY: all clean profile

all: $(OBJDIR) $(TARGET)

$(OBJDIR):
	mkdir -vp $(OBJDIR)

$(TARGET): $(OBJCPP) $(OBJC)
	$(CC) -o $@ $(OBJCPP) $(OBJC) $(LIB)

clean:
	rm -rf $(OBJDIR) $(TARGET)

profile: $(TARGET)
	valgrind --leak-check=full --show-leak-kinds=all ./$(TARGET)
